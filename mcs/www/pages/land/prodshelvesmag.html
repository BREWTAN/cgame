<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en" class="no-js">
<!--<![endif]-->
<!-- BEGIN HEAD -->
<head>
    <base href="../../" >

    <meta charset="utf-8"/>
    <title>民生宝-产品上下架流水管理</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta charset="utf-8" />
        <link rel="stylesheet" type="text/css" href="assets/global/plugins/bootstrap-select/bootstrap-select.min.css">
    <link rel="stylesheet" type="text/css" href="assets/global/plugins/select2/select2.css">
       <link rel="stylesheet" type="text/css" href="assets/global/plugins/bootstrap-datepicker/css/datepicker3.css"/>
    <link rel='stylesheet' href='assets/global/plugins/jquery-watable/watable.css'/>
    <link rel='stylesheet' href='assets/global/plugins/jquery-watable/animate.min.css'/>

    <script type="text/javascript" src="parts/js/header.js"></script>
    <script type="text/javascript" src="parts/js/wpfcfg.js"></script>
</head>
<body class="page-header-fixed page-quick-sidebar-over-content">
    <script>$.include("parts/pages/topmenu.shtml");</script>
<div class="clearfix">
</div>
<!-- BEGIN CONTAINER -->
<div class="page-container">
    <script>$.include("parts/pages/sidebar.shtml");</script>

    <!-- END SIDEBAR -->
    <!-- BEGIN CONTENT -->
    <div class="page-content-wrapper">
        <div class="page-content">
            <script>$.include("parts/pages/style.shtml");</script>

            <!-- BEGIN PAGE HEADER-->
            <h3 class="page-title">
            产品渠道管理 <small>产品上下架流水管理</small>
            </h3>
            <div class="page-bar">
                <ul class="page-breadcrumb">
                    <li>
                        <i class="fa fa-home"></i>
                        <a href="index.html"></a>
                        <i class="fa fa-angle-right"></i>
                    </li>
                    <li>
                        <a href="#"></a>
                    </li>
                </ul>
                <div class="page-toolbar">
                    <div id="dashboard-report-range" class="pull-right tooltips btn btn-fit-height grey-salt" data-placement="top" data-original-title="Change dashboard date range">
                        <i class="icon-calendar"></i>&nbsp;
                        <span class="thin uppercase visible-lg-inline-block">&nbsp;</span>&nbsp;
                        <i class="fa fa-angle-down"></i>
                    </div>
                </div>
            </div>
            <!-- END PAGE HEADER-->
            <div class="note note-success container col-sm-12" style="padding-bottom:0px">
                <div class="col-sm-3 form-group">
                    <div class="btn-group input-group">
                    <!-- 查询条件控件 -->
                        <div class="input-group-addon">产品名字</div>
                        <input id="find_productName" class="inputclear form-control" type="text">
                        <span class="inputclear glyphicon glyphicon-remove-circle hide" ></span>
                    </div>
                </div>
                <div class="col-sm-3 form-group">
                    <div class="btn-group input-group">
                    <!-- 查询条件控件 -->
                        <div class="input-group-addon">商户编号</div>
                        <input id="find_mchntId" class="inputclear form-control" type="text">
                        <span class="inputclear glyphicon glyphicon-remove-circle hide" ></span>
                    </div>
                </div><div class="col-sm-3 form-group">
                    <div class="btn-group input-group">
                    <!-- 查询条件控件 -->
                        <div class="input-group-addon">外部产品编号</div>
                        <input id="find_outProdId" class="inputclear form-control" type="text">
                        <span class="inputclear glyphicon glyphicon-remove-circle hide" ></span>
                    </div>
                 </div>
                <div class="col-sm-3 form-group">
                    <div class="btn-group input-group">
                        <div class="input-group-addon">产品类型</div>
                        <select class="form-control chosen-select" id="find_productType">
                                <option value="-1">全部</option>
                                <option value="FUND">基金产品</option>
                                <option value="FNLN">融资贷款类产品</option>
                                <option value="OFAG">开放式理财类产品（代理）</option>
                                <option value="CFAG">封闭式理财类产品（代理）</option>
                        </select>
                    </div>
                </div>
                <div class="col-sm-3 form-group">
                    <div class="btn-group input-group">
                        <div class="input-group-addon">状态</div>
                        <select class="form-control chosen-select" id="find_productStatus">
                                <option value="-1">全部</option>
                                <option value="00">审批成功</option>
                                <option value="02">审批失败</option>
                                <option value="01">待审批</option>
                        </select>
                    </div>
                </div>
                <div class="col-sm-3 form-group">
                    <div class="btn-group input-group">
                        <div class="input-group-addon">上下架标识</div>
                        <select class="form-control chosen-select" id="find_shelvesType">
                                <option value="-1">全部</option>
                                <option value="1">上架申请</option>
                                <option value="2">下架申请</option>
                        </select>
                    </div>
                </div>
                <div class="col-sm-5 form-group">
                    <div class="btn-group btn-sm">
					    <button id="find_button" class="btn btn-sm btn-primary">
					        查询&nbsp; <i class="fa fa-search"></i>
					    </button>
					</div>
                </div>
            </div>
            <div class="container-fluid">
                <div id="divtable" class="table-responsive container col-md-12" >
                </div>
            </div>
            <div class="clearfix">
            </div>
        </div>
    </div>
    <!-- END CONTENT -->
    <script>$.include("parts/pages/quicksidebar.shtml");</script>

</div>
<!-- END CONTAINER -->
<!-- BEGIN FOOTER -->


<script type="text/javascript">$.include("parts/pages/xwatable-form.shtml");</script>
<script>$.include("parts/pages/foot_table.shtml");</script>
<script type="text/javascript" src="assets/addons/jquery.uuid.js"></script>

<script type="text/javascript">

var productTypeFormatter=function(){
    return {
        f: function(val){
        	if(val&&val=="FUND") return "基金产品 ";
        	else if(val&&val=="FNLN") return "融资贷款类产品";
            else if(val&&val=="OFAG") return "开放式理财类产品（代理）";
            else if(val&&val=="CFAG") return "封闭式理财类产品（代理）";
            else return "无此状态";
        },
    };
}();
var procStatusFormatter=function(){
    return {
        f: function(val){
        	if(val&&val=="00") return "审批成功";
        	else if(val&&val=="01") return "待审批";
            else if(val&&val=="02") return "审批失败";
            else return "无此状态";
        },
    };
}();
var shelvesTypeFormatter=function(){
    return {
        f: function(val){
        	if(val&&val=="1") return "上架申请";
        	else if(val&&val=="2") return "下架申请";
            else return "无此状态";
        },
    };
}();


$(function(){ 
	//初始化页面标题
	initTitle();

     var xw=XWATable.init(
        {
            //----------------table的选项-------
            pageSize: 10,                //Initial pagesize
                    // filter: true,               //Show filter fields
                    // sorting: true,              //Enable sorting
            columnPicker: true,         //Show the columnPicker button
            transition: 'fade',  //(bounce, fade, flip, rotate, scroll, slide).
            // pageSizes: [1,5,8,12,200],  //Set custom pageSizes. Leave empty array to hide button.
            // hidePagerOnEmpty: true,     //Removes the pager if data is empty.
            checkboxes: true,           //Make rows checkable. (Note. You need a column with the 'unique' property)
            checkAllToggle:true,        //Show the check-all toggle//+RQLBuilder.like("KEYY", "a").rql()
            rowClicked: function(data) {    
                console.log('row clicked');   //data.event holds the original jQuery event.
                console.log(data);            //data.row holds the underlying row you supplied.
            },
            logicaldel:false,
            //xwattr:'audit',
            //xwtitle:'添加渠道',
            //readonly:"addchannel",
            //----------------基本restful地址---
            restbase: restpath +'/landshelvesmag',
            key_column: "applyId",
            //---------------行定义
            coldefs: [
                        {      
                            col:"applyId",
                            friendly: "主键",
                            unique: true,
                        },
                        {
                            col:"mchntId",
                            friendly: "商户编号",
                        },{
                            col:"outProdId",
                            friendly: "外部产品id",
                        },{
                            col:"outSubProdId",
                            friendly: "外部产品子id",
                        },{
                            col:"productName",
                            friendly: "产品名字",
                        },{
                            col:"productType",
                            friendly: "产品类型",                            
                            filterTooltip:true,                     
                            format: productTypeFormatter,
                            inputsource: "custom",
                        },{
                            col:"idrespId",
                            friendly: "应答",
                        },{
                            col:"shelvesType",
                            friendly: "上下架标识",
                            filterTooltip:true,                     
                            format: shelvesTypeFormatter,
                            inputsource: "custom",
                        },{
                            col:"procStatus",
                            friendly: "状态",
                            filterTooltip:true,                     
                            format: procStatusFormatter,
                            inputsource: "custom",
                        },{
                            col:"procDesc",
                            friendly: "审批意见",
                        },{
                            col:"createTime",
                            friendly: "申请时间",
                        },
                        
                ],
            //---------------查询时过滤条件
            findFilter: function(){//find function
                
            	var productName,mchntId,outProdId,productStatus,shelvesType,productType;
                if($('#find_productName').val().length>0) productName=RQLBuilder.like("productName",$('#find_productName').val());
                if($('#find_mchntId').val().length>0) mchntId=RQLBuilder.equal("mchntId",$('#find_mchntId').val());
                if($('#find_outProdId').val().length>0) outProdId=RQLBuilder.equal("outProdId",$('#find_outProdId').val());
                if($('#find_productStatus').val()!=-1)productStatus=RQLBuilder.equal("procStatus",$('#find_productStatus').val());
                if($('#find_productType').val()!=-1)productType=RQLBuilder.equal("productType",$('#find_productType').val());
                if($('#find_shelvesType').val()!=-1)shelvesType=RQLBuilder.equal("shelvesType",$('#find_shelvesType').val());

                var filter=RQLBuilder.and([
					productName,mchntId,outProdId,productStatus,shelvesType,productType
                    ]);
                return filter.rql();
            },//--findFilter
            onAdded: function(ret,jsondata){
                console.log("added callback:"+ret+",obj="+JSON.stringify(jsondata));
                return  validateForm(ret,jsondata);
            },
            onUpdated: function(ret,jsondata){
                console.log("onUpdated callback:"+ret+",obj="+JSON.stringify(jsondata));
                return  validateForm(ret,jsondata);
            },
            onDeleted: function(ret,jsondata){
                console.log("onDeleted callback:"+ret+",obj="+JSON.stringify(jsondata));
            },
        }//--init
    );//--end init

    //$('#find_leaf').select2();
    $('#find_name').on('input',function(e){
        console.log("changing::"+e.target.value);
        if(!e.target.value){
            xw.autoResetSearch();
        }
    });

    
//-----------------ENDOFSCIPT------
}
);

</script><!-- End of User Script-->
<!-- END JAVASCRIPTS -->
</body>
<!-- END BODY -->
</html>